% Author: Julien Cubizolles
% Public domain

\RequirePackage{tikz}

\AtBeginDocument{%
  \@ifpackageloaded{babel}{%
    \let\xCJtikz@tikzpicture\tikzpicture
    \def\tikzpicture{%
      \iflanguage{french}{%
        \shorthandoff{:;?!}}{}%
      \xCJtikz@tikzpicture}%
    \let\xCJtikz@tikzexternal@tikzpicture@replacement%
        \tikzexternal@tikzpicture@replacement
    \def\tikzexternal@tikzpicture@replacement{%
      \iflanguage{french}{%
        \shorthandoff{:;?!}}{}%
      \xCJtikz@tikzexternal@tikzpicture@replacement}}{}}

\usetikzlibrary{calc}
\usetikzlibrary{patterns}
\usetikzlibrary{intersections}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}

\usetikzlibrary{arrows.meta}
\tikzset{>={Latex[round]}}
\tikzset{coordonnees/.style={dashed,VeryDarkGray,text=black,thick}}
\tikzset{base/.style={very thick,->}}
\tikzset{style courant/.style={very thick,text=black}}
\tikzset{force/.style={->,very thick}}
\tikzset{vitesse/.style={->,very thick}}
\tikzset{point/.style={radius=1pt}}
\tikzset{photon/.style={decorate, decoration={snake,post length=1mm},->}}

\pgfkeys{/pgf/number format/.cd, set decimal separator={,}, 1000 sep={ }}

\pgfmathsetmacro\PiNum{3.14159}

\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfdeclarelayer{points}
\pgfsetlayers{background,main,foreground,points}

\tikzset{
  grid with coordinates/.style={
    to path={%
      \pgfextra{%
        \edef\grd@@target{(\tikztotarget)}%
        \tikz@scan@one@point\grd@save@target\grd@@target\relax
        \edef\grd@@start{(\tikztostart)}%
        \tikz@scan@one@point\grd@save@start\grd@@start\relax
        \draw[minor help lines] (\tikztostart) grid (\tikztotarget);
        \draw[major help lines] (\tikztostart) grid (\tikztotarget);
        \grd@start
        \pgfmathsetmacro{\grd@xa}{\the\pgf@x/1cm}
        \pgfmathsetmacro{\grd@ya}{\the\pgf@y/1cm}
        \grd@target
        \pgfmathsetmacro{\grd@xb}{\the\pgf@x/1cm}
        \pgfmathsetmacro{\grd@yb}{\the\pgf@y/1cm}
        \pgfmathsetmacro{\grd@xc}{\grd@xa + \pgfkeysvalueof{/tikz/grid with coordinates/major step}}
        \pgfmathsetmacro{\grd@yc}{\grd@ya + \pgfkeysvalueof{/tikz/grid with coordinates/major step}}
        \foreach \x in {\grd@xa,\grd@xc,...,\grd@xb}
        \node[anchor=north] at (\x,\grd@ya) {\pgfmathprintnumber{\x}};
        \foreach \y in {\grd@ya,\grd@yc,...,\grd@yb}
        \node[anchor=east] at (\grd@xa,\y) {\pgfmathprintnumber{\y}};
      }
    }
  },
  minor help lines/.style={
    help lines,
    step=\pgfkeysvalueof{/tikz/grid with coordinates/minor step}
  },
  major help lines/.style={
    help lines,
    line width=\pgfkeysvalueof{/tikz/grid with coordinates/major line width},
    step=\pgfkeysvalueof{/tikz/grid with coordinates/major step}
  },
  grid with coordinates/.cd,
  minor step/.initial=.2,
  major step/.initial=1,
  major line width/.initial=2pt,
}

%% Pour avoir des flèches à bout rond centré sur la coordonnée
\pgfarrowsdeclare{c*}{c*}{}
{
  \pgfutil@tempdima=0.4pt%
  \advance\pgfutil@tempdima by.2\pgflinewidth%
  \pgfsetdash{}{+0pt}
  \pgfpathcircle{\pgfqpoint{0pt}{0pt}}{+4.5\pgfutil@tempdima}
  \pgfusepathqfillstroke
}

\tikzstyle{arrowmid}[0.5]=[decoration= 
{markings, 
mark=at position #1 with {\arrow{>}}}, 
postaction={decorate}]

\tikzstyle{arrowmid'}[0.5]=[decoration= 
{markings, 
mark=at position #1 with {\arrow{<}}}, 
postaction={decorate}]

\tikzset{%
  point materiel/.style = {%
    minimum width = 1cm,
    rectangle,
    fill=UltraDarkGray,
    very thick,
    rounded corners,
    draw,
}}
